#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include "l0_arena.h" // Include first for l0_arena_alloc_type etc.
#include "l0_types.h" // Defines L0_Value, L0_NIL etc.
#include "l0_parser.h" // Needed for error status/message
#include "l0_env.h"   // Defines L0_Env, l0_env_create etc.
#include "l0_primitives.h" // Declares prim_add etc.
#include "l0_eval.h" // Needed for potential closure application (though not used in basic codegen)

// Make argc/argv globally accessible for the command-line-args primitive
// (Defined in l0_primitives.c)
extern int g_argc;
extern char **g_argv;

// Forward declare print helper (implementation might be linked separately or included)
// static int l0_value_to_string_recursive(L0_Value* value, char* buffer, size_t buf_size, L0_Arena* arena, int depth);

int main(int argc, char *argv[]) {
    // Store argc/argv globally for command-line-args primitive
    g_argc = argc;
    g_argv = argv;

    L0_Arena* arena = l0_arena_create(1024 * 1024); // 1MB initial size
    if (!arena) { fprintf(stdout, "Failed to create memory arena.\n"); fflush(stdout); return 1; }

    L0_Env* env = l0_env_create(arena, NULL);
    if (!env) { fprintf(stdout, "Failed to create global environment.\n"); fflush(stdout); l0_arena_destroy(arena); return 1; }

    if (!l0_register_primitives(env, arena)) {
         fprintf(stdout, "Failed to register primitives.\n"); fflush(stdout);
         l0_arena_destroy(arena);
         return 1;
    }

    L0_Value* last_result = L0_NIL; // Initialize
    L0_Value* temp_result = NULL; // For individual expression results
    int exit_code = 0; // Default success
    (void)last_result; // Avoid unused warning for now

    // --- Block 1: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 1...\n"); fflush(stdout); // DEBUG
    { L0_Value* define_val = l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "quasiquote")), l0_make_pair(arena, L0_NIL, L0_NIL), env, arena); if (define_val != NULL && l0_parser_error_status == L0_PARSE_OK) { (void)l0_env_define(env, l0_make_symbol(arena, "*macro-table*"), define_val); } else { /* Value evaluation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (1 != 1) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 1, got %d\n", 1); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 2: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 2...\n"); fflush(stdout); // DEBUG
    { L0_Value* define_val = l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "quasiquote")), l0_make_pair(arena, L0_NIL, L0_NIL), env, arena); if (define_val != NULL && l0_parser_error_status == L0_PARSE_OK) { (void)l0_env_define(env, l0_make_symbol(arena, "*c-declarations*"), define_val); } else { /* Value evaluation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (2 != 2) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 2, got %d\n", 2); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 3: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 3...\n"); fflush(stdout); // DEBUG
    { L0_Value* define_val = l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "quasiquote")), l0_make_pair(arena, L0_NIL, L0_NIL), env, arena); if (define_val != NULL && l0_parser_error_status == L0_PARSE_OK) { (void)l0_env_define(env, l0_make_symbol(arena, "*c-exports-code*"), define_val); } else { /* Value evaluation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (3 != 3) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 3, got %d\n", 3); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 4: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 4...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "c-declare"), L0_NIL)), L0_NIL))), L0_NIL))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "is-c-declare?"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (4 != 4) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 4, got %d\n", 4); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 5: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 5...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "c-export"), L0_NIL)), L0_NIL))), L0_NIL))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "is-c-export?"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (5 != 5) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 5, got %d\n", 5); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 6: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 6...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "sym"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL)); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL)), l0_make_pair(arena, l0_make_boolean(arena, false), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "entry"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL)), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "entry"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "sym"), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, true), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "is-macro?"), l0_make_pair(arena, l0_make_symbol(arena, "sym"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL)), L0_NIL))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "is-macro?"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (6 != 6) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 6, got %d\n", 6); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 7: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 7...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "sym"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL)); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL)), l0_make_pair(arena, l0_make_boolean(arena, false), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "entry"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL)), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "entry"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "sym"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "entry"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-macro-transformer"), l0_make_pair(arena, l0_make_symbol(arena, "sym"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL)), L0_NIL))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "get-macro-transformer"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (7 != 7) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 7, got %d\n", 7); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 8: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 8...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "list1"), l0_make_pair(arena, l0_make_symbol(arena, "list2"), L0_NIL)); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "list1"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "list2"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "list1"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "append"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "list1"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "list2"), L0_NIL))), L0_NIL))), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "append"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (8 != 8) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 8, got %d\n", 8); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 9: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 9...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "lst"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "reverse-iter"), l0_make_pair(arena, l0_make_symbol(arena, "items"), l0_make_pair(arena, l0_make_symbol(arena, "result"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "items"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "result"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "reverse-iter"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "items"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "items"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "result"), L0_NIL))), L0_NIL))), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "reverse-iter"), l0_make_pair(arena, l0_make_symbol(arena, "lst"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, L0_NIL, L0_NIL)), L0_NIL))), L0_NIL)); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "reverse"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (9 != 9) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 9, got %d\n", 9); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 10: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 10...\n"); fflush(stdout); // DEBUG
    { L0_Value* define_val = l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "quasiquote")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "<splice-marker>")), L0_NIL), env, arena); if (define_val != NULL && l0_parser_error_status == L0_PARSE_OK) { (void)l0_env_define(env, l0_make_symbol(arena, "*splice-marker*"), define_val); } else { /* Value evaluation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (10 != 10) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 10, got %d\n", 10); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 11: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 11...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "val"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "val"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "val"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "*splice-marker*"), L0_NIL))), L0_NIL))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "is-splice-list?"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (11 != 11) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 11, got %d\n", 11); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 12: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 12...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "val"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "val"), L0_NIL)), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "get-spliced-list"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (12 != 12) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 12, got %d\n", 12); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 13: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 13...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "expr"), l0_make_pair(arena, l0_make_symbol(arena, "level"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL))); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, L0_NIL, L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "args"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "expanded-inner"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "expand-quasiquote"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "+"), l0_make_pair(arena, l0_make_symbol(arena, "level"), l0_make_pair(arena, l0_make_integer(arena, 1L), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL)))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "expanded-inner"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: quasiquote requires exactly one argument."), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL))), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "unquote"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "level"), l0_make_pair(arena, l0_make_integer(arena, 1L), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "macro-expand"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "expanded-inner"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "expand-quasiquote"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "-"), l0_make_pair(arena, l0_make_symbol(arena, "level"), l0_make_pair(arena, l0_make_integer(arena, 1L), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL)))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "unquote"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "expanded-inner"), L0_NIL))), L0_NIL))), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: unquote requires exactly one argument."), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL))), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "unquote-splicing"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "level"), l0_make_pair(arena, l0_make_integer(arena, 1L), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "result-to-splice"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "macro-expand"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list?"), l0_make_pair(arena, l0_make_symbol(arena, "result-to-splice"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "*splice-marker*"), l0_make_pair(arena, l0_make_symbol(arena, "result-to-splice"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: unquote-splicing argument must expand to a list:"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL))), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "expanded-inner"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "expand-quasiquote"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "-"), l0_make_pair(arena, l0_make_symbol(arena, "level"), l0_make_pair(arena, l0_make_integer(arena, 1L), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL)))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "unquote-splicing"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "expanded-inner"), L0_NIL))), L0_NIL))), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: unquote-splicing requires exactly one argument."), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL))), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "expanded-car"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "expand-quasiquote"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "level"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "expanded-cdr"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "expand-quasiquote"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "level"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL)))), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "is-splice-list?"), l0_make_pair(arena, l0_make_symbol(arena, "expanded-car"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "append"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-spliced-list"), l0_make_pair(arena, l0_make_symbol(arena, "expanded-car"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "expanded-cdr"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "expanded-car"), l0_make_pair(arena, l0_make_symbol(arena, "expanded-cdr"), L0_NIL))), L0_NIL)))), L0_NIL))), L0_NIL)), L0_NIL))))), L0_NIL))), L0_NIL)), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "expand-quasiquote"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (13 != 13) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 13, got %d\n", 13); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 14: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 14...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "expr"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL)); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "expr"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "args"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "quote"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "lambda"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "expand-quasiquote"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), l0_make_pair(arena, l0_make_integer(arena, 1L), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: quasiquote requires exactly one argument."), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL))), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol?"), l0_make_pair(arena, l0_make_symbol(arena, "op"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "is-macro?"), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "transformer"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-macro-transformer"), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_symbol(arena, "transformer"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "[Macro Expand] Applying transformer for macro:"), l0_make_pair(arena, l0_make_symbol(arena, "op"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "application-expr"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "transformer"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "[Macro Expand] Constructed application expr:"), l0_make_pair(arena, l0_make_symbol(arena, "application-expr"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "expanded"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "eval-in-compiler-env"), l0_make_pair(arena, l0_make_symbol(arena, "application-expr"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "[Macro Expand] Macro"), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_string(arena, "expanded to:"), l0_make_pair(arena, l0_make_symbol(arena, "expanded"), L0_NIL))))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "boolean?"), l0_make_pair(arena, l0_make_symbol(arena, "expanded"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "expanded"), l0_make_pair(arena, l0_make_symbol(arena, "application-expr"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error during macro expansion evaluation for:"), l0_make_pair(arena, l0_make_symbol(arena, "op"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "err-msg"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-last-error-message"), L0_NIL), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string?"), l0_make_pair(arena, l0_make_symbol(arena, "err-msg"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Reason:"), l0_make_pair(arena, l0_make_symbol(arena, "err-msg"), L0_NIL))), l0_make_pair(arena, L0_NIL, L0_NIL)))), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL))))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "macro-expand"), l0_make_pair(arena, l0_make_symbol(arena, "expanded"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL))), L0_NIL)))), L0_NIL))))))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: Invalid transformer lambda expression found for macro:"), l0_make_pair(arena, l0_make_symbol(arena, "op"), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL))), L0_NIL)))), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "expanded-op"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "macro-expand"), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "expanded-args"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "map"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "lambda"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "arg"), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "macro-expand"), l0_make_pair(arena, l0_make_symbol(arena, "arg"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL))), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "expanded-op"), l0_make_pair(arena, l0_make_symbol(arena, "expanded-args"), L0_NIL))), L0_NIL))), L0_NIL)), L0_NIL)))))), L0_NIL))), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "macro-expand"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (14 != 14) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 14, got %d\n", 14); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 15: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 15...\n"); fflush(stdout); // DEBUG
    temp_result = l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "defmacro")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "when")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "condition")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "body")), L0_NIL), env, arena), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "quasiquote")), l0_make_pair(arena, ({ L0_Value* cond_val = l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "unquote")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "condition")), L0_NIL), env, arena); L0_Value* if_res = L0_NIL; if (L0_IS_TRUTHY(cond_val)) { if_res = l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "unquote")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "body")), L0_NIL), env, arena); } else { if_res = l0_make_boolean(arena, false); } if_res; }), L0_NIL), env, arena), L0_NIL))), env, arena);
    if (15 != 15) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 15, got %d\n", 15); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 16: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 16...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "items"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "items"), L0_NIL)), l0_make_pair(arena, l0_make_integer(arena, 0L), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "+"), l0_make_pair(arena, l0_make_integer(arena, 1L), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "length"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "items"), L0_NIL)), L0_NIL)), L0_NIL))), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "length"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (16 != 16) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 16, got %d\n", 16); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 17: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 17...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "proc"), l0_make_pair(arena, l0_make_symbol(arena, "items"), L0_NIL)); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "items"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, L0_NIL, L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "proc"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "items"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "map"), l0_make_pair(arena, l0_make_symbol(arena, "proc"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "items"), L0_NIL)), L0_NIL))), L0_NIL))), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "map"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (17 != 17) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 17, got %d\n", 17); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 18: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 18...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "pred"), l0_make_pair(arena, l0_make_symbol(arena, "items"), L0_NIL)); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "items"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, L0_NIL, L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "head"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "items"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "tail"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "items"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pred"), l0_make_pair(arena, l0_make_symbol(arena, "head"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "head"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "filter"), l0_make_pair(arena, l0_make_symbol(arena, "pred"), l0_make_pair(arena, l0_make_symbol(arena, "tail"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "filter"), l0_make_pair(arena, l0_make_symbol(arena, "pred"), l0_make_pair(arena, l0_make_symbol(arena, "tail"), L0_NIL))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "filter"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (18 != 18) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 18, got %d\n", 18); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 19: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 19...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "pred"), l0_make_pair(arena, l0_make_symbol(arena, "items"), L0_NIL)); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "items"), L0_NIL)), l0_make_pair(arena, l0_make_boolean(arena, false), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pred"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "items"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_boolean(arena, true), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "any?"), l0_make_pair(arena, l0_make_symbol(arena, "pred"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "items"), L0_NIL)), L0_NIL))), L0_NIL)))), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "any?"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (19 != 19) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 19, got %d\n", 19); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 20: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 20...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "lst"), l0_make_pair(arena, l0_make_symbol(arena, "n"), L0_NIL)); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "n"), l0_make_pair(arena, l0_make_integer(arena, 0L), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "lst"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, L0_NIL, L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "lst"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "take"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "lst"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "-"), l0_make_pair(arena, l0_make_symbol(arena, "n"), l0_make_pair(arena, l0_make_integer(arena, 1L), L0_NIL))), L0_NIL))), L0_NIL))), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "take"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (20 != 20) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 20, got %d\n", 20); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 21: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 21...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "lst"), l0_make_pair(arena, l0_make_symbol(arena, "n"), L0_NIL)); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "n"), l0_make_pair(arena, l0_make_integer(arena, 0L), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "lst"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "lst"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "drop"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "lst"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "-"), l0_make_pair(arena, l0_make_symbol(arena, "n"), l0_make_pair(arena, l0_make_integer(arena, 1L), L0_NIL))), L0_NIL))), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "drop"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (21 != 21) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 21, got %d\n", 21); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 22: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 22...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "name"), l0_make_pair(arena, l0_make_symbol(arena, "transformer"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL))); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "set!"), l0_make_pair(arena, l0_make_symbol(arena, "*macro-table*"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "name"), l0_make_pair(arena, l0_make_symbol(arena, "transformer"), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "*macro-table*"), L0_NIL)); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "add-macro!"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (22 != 22) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 22, got %d\n", 22); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 23: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 23...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "defmacro"), L0_NIL)), L0_NIL))), L0_NIL))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "is-defmacro?"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (23 != 23) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 23, got %d\n", 23); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 24: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 24...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "<"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "length"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), l0_make_pair(arena, l0_make_integer(arena, 4L), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: Invalid defmacro form:"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "macro-name"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "macro-params"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "caddr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "macro-body"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdddr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol?"), l0_make_pair(arena, l0_make_symbol(arena, "macro-name"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: Macro name must be a symbol:"), l0_make_pair(arena, l0_make_symbol(arena, "macro-name"), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list?"), l0_make_pair(arena, l0_make_symbol(arena, "macro-params"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: Macro parameters must be a list:"), l0_make_pair(arena, l0_make_symbol(arena, "macro-params"), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "transformer-lambda"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "lambda"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "macro-params"), l0_make_pair(arena, l0_make_symbol(arena, "macro-body"), L0_NIL)))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "macro-name"), l0_make_pair(arena, l0_make_symbol(arena, "transformer-lambda"), L0_NIL))), L0_NIL))), L0_NIL)))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "process-defmacro"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (24 != 24) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 24, got %d\n", 24); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 25: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 25...\n"); fflush(stdout); // DEBUG
    { L0_Value* define_val = l0_make_integer(arena, 0L); if (define_val != NULL && l0_parser_error_status == L0_PARSE_OK) { (void)l0_env_define(env, l0_make_symbol(arena, "*next-scope-id*"), define_val); } else { /* Value evaluation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (25 != 25) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 25, got %d\n", 25); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 26: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 26...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = L0_NIL; L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "id"), l0_make_pair(arena, l0_make_symbol(arena, "*next-scope-id*"), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "set!"), l0_make_pair(arena, l0_make_symbol(arena, "*next-scope-id*"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "+"), l0_make_pair(arena, l0_make_symbol(arena, "id"), l0_make_pair(arena, l0_make_integer(arena, 1L), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "id"), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "generate-scope-id"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (26 != 26) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 26, got %d\n", 26); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 27: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 27...\n"); fflush(stdout); // DEBUG
    { L0_Value* define_val = l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "quasiquote")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "global")), L0_NIL), env, arena); if (define_val != NULL && l0_parser_error_status == L0_PARSE_OK) { (void)l0_env_define(env, l0_make_symbol(arena, "*global-scope-id*"), define_val); } else { /* Value evaluation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (27 != 27) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 27, got %d\n", 27); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 28: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 28...\n"); fflush(stdout); // DEBUG
    temp_result = prim_cdr(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "pair")), L0_NIL, env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "any")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (28 != 28) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 28, got %d\n", 28); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 29: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 29...\n"); fflush(stdout); // DEBUG
    temp_result = prim_add(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "number")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "...")), L0_NIL), env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "number")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (29 != 29) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 29, got %d\n", 29); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 30: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 30...\n"); fflush(stdout); // DEBUG
    temp_result = prim_subtract(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "number")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "...")), L0_NIL), env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "number")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (30 != 30) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 30, got %d\n", 30); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 31: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 31...\n"); fflush(stdout); // DEBUG
    temp_result = prim_multiply(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "number")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "...")), L0_NIL), env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "number")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (31 != 31) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 31, got %d\n", 31); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 32: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 32...\n"); fflush(stdout); // DEBUG
    temp_result = prim_divide(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "number")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "...")), L0_NIL), env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "float")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (32 != 32) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 32, got %d\n", 32); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 33: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 33...\n"); fflush(stdout); // DEBUG
    temp_result = prim_equal(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "number")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "number")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "...")), L0_NIL)), env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "bool")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (33 != 33) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 33, got %d\n", 33); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 34: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 34...\n"); fflush(stdout); // DEBUG
    temp_result = prim_less_than(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "number")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "number")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "...")), L0_NIL)), env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "bool")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (34 != 34) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 34, got %d\n", 34); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 35: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 35...\n"); fflush(stdout); // DEBUG
    temp_result = prim_greater_than(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "number")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "number")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "...")), L0_NIL)), env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "bool")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (35 != 35) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 35, got %d\n", 35); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 36: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 36...\n"); fflush(stdout); // DEBUG
    temp_result = prim_pair_q(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "any")), L0_NIL, env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "bool")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (36 != 36) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 36, got %d\n", 36); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 37: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 37...\n"); fflush(stdout); // DEBUG
    temp_result = prim_null_q(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "any")), L0_NIL, env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "bool")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (37 != 37) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 37, got %d\n", 37); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 38: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 38...\n"); fflush(stdout); // DEBUG
    temp_result = prim_integer_q(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "any")), L0_NIL, env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "bool")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (38 != 38) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 38, got %d\n", 38); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 39: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 39...\n"); fflush(stdout); // DEBUG
    temp_result = prim_boolean_q(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "any")), L0_NIL, env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "bool")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (39 != 39) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 39, got %d\n", 39); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 40: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 40...\n"); fflush(stdout); // DEBUG
    temp_result = prim_symbol_q(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "any")), L0_NIL, env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "bool")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (40 != 40) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 40, got %d\n", 40); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 41: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 41...\n"); fflush(stdout); // DEBUG
    temp_result = prim_string_q(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "any")), L0_NIL, env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "bool")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (41 != 41) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 41, got %d\n", 41); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 42: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 42...\n"); fflush(stdout); // DEBUG
    temp_result = prim_float_q(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "any")), L0_NIL, env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "bool")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (42 != 42) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 42, got %d\n", 42); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 43: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 43...\n"); fflush(stdout); // DEBUG
    temp_result = prim_closure_p(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "any")), L0_NIL, env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "bool")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (43 != 43) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 43, got %d\n", 43); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 44: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 44...\n"); fflush(stdout); // DEBUG
    temp_result = prim_string_append(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "string")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "...")), L0_NIL), env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "string")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (44 != 44) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 44, got %d\n", 44); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 45: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 45...\n"); fflush(stdout); // DEBUG
    temp_result = prim_string_to_symbol(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "string")), L0_NIL, env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "symbol")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (45 != 45) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 45, got %d\n", 45); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 46: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 46...\n"); fflush(stdout); // DEBUG
    temp_result = prim_symbol_to_string(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "symbol")), L0_NIL, env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "string")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (46 != 46) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 46, got %d\n", 46); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 47: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 47...\n"); fflush(stdout); // DEBUG
    temp_result = prim_print(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "any")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "...")), L0_NIL), env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "bool")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (47 != 47) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 47, got %d\n", 47); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 48: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 48...\n"); fflush(stdout); // DEBUG
    temp_result = prim_read_file(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "string")), L0_NIL, env, arena), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "or")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "string")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "bool")), L0_NIL)), env, arena), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (48 != 48) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 48, got %d\n", 48); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 49: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 49...\n"); fflush(stdout); // DEBUG
    temp_result = prim_write_file(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "string")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "string")), L0_NIL), env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "bool")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (49 != 49) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 49, got %d\n", 49); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 50: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 50...\n"); fflush(stdout); // DEBUG
    temp_result = prim_command_line_args(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, L0_NIL, l0_make_pair(arena, L0_NIL /* Fixed: prim_list(...) */, L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (50 != 50) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 50, got %d\n", 50); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 51: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 51...\n"); fflush(stdout); // DEBUG
    temp_result = prim_parse_string(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "string")), L0_NIL, env, arena), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "or")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "list")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "bool")), L0_NIL)), env, arena), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (51 != 51) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 51, got %d\n", 51); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 52: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 52...\n"); fflush(stdout); // DEBUG
    temp_result = prim_codegen_program(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, L0_NIL /* Fixed: prim_list(...) */, l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "or")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "string")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "bool")), L0_NIL)), env, arena), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (52 != 52) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 52, got %d\n", 52); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 53: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 53...\n"); fflush(stdout); // DEBUG
    temp_result = prim_append(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, L0_NIL /* Fixed: prim_list(...) */, l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "list")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (53 != 53) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 53, got %d\n", 53); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 54: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 54...\n"); fflush(stdout); // DEBUG
    temp_result = prim_eval(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "any")), L0_NIL, env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "any")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (54 != 54) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 54, got %d\n", 54); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 55: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 55...\n"); fflush(stdout); // DEBUG
    temp_result = prim_apply(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "any")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "list")), L0_NIL), env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "any")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (55 != 55) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 55, got %d\n", 55); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 56: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 56...\n"); fflush(stdout); // DEBUG
    temp_result = prim_eval_in_compiler_env(l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "any")), L0_NIL, env, arena), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "any")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (56 != 56) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 56, got %d\n", 56); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 57: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 57...\n"); fflush(stdout); // DEBUG
    temp_result = l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "deref")), l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, ".")), l0_make_pair(arena, l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "->")), l0_make_pair(arena, L0_NIL, l0_make_pair(arena, l0_env_lookup(env, l0_make_symbol(arena, "any")), L0_NIL)), env, arena), L0_NIL)), env, arena);
    if (57 != 57) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 57, got %d\n", 57); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 58: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 58...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "key"), l0_make_pair(arena, l0_make_symbol(arena, "alist"), L0_NIL)); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "alist"), L0_NIL)), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "key"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "alist"), L0_NIL)), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "alist"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "assoc"), l0_make_pair(arena, l0_make_symbol(arena, "key"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "alist"), L0_NIL)), L0_NIL))), L0_NIL)), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "assoc"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (58 != 58) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 58, got %d\n", 58); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 59: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 59...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "sym"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), L0_NIL)); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), L0_NIL)), l0_make_pair(arena, l0_make_boolean(arena, false), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "frame"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "outer-env"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "binding"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "assoc"), l0_make_pair(arena, l0_make_symbol(arena, "sym"), l0_make_pair(arena, l0_make_symbol(arena, "frame"), L0_NIL))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_symbol(arena, "binding"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "binding"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "lookup-type-info"), l0_make_pair(arena, l0_make_symbol(arena, "sym"), l0_make_pair(arena, l0_make_symbol(arena, "outer-env"), L0_NIL))), L0_NIL)))), L0_NIL))), L0_NIL))), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "lookup-type-info"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (59 != 59) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 59, got %d\n", 59); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 60: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 60...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "unknown-type"), L0_NIL)), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "get-type-from-info"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (60 != 60) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 60, got %d\n", 60); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 61: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 61...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL)), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "*global-scope-id*"), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "get-scope-id-from-info"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (61 != 61) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 61, got %d\n", 61); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 62: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 62...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cddr"), l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL)), L0_NIL)), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "caddr"), l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "not-borrowed"), L0_NIL)), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "get-borrow-status-from-info"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (62 != 62) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 62, got %d\n", 62); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 63: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 63...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "frame"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), L0_NIL)); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "frame"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), L0_NIL))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "extend-type-env"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (63 != 63) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 63, got %d\n", 63); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 64: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 64...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "sym"), l0_make_pair(arena, l0_make_symbol(arena, "type"), l0_make_pair(arena, l0_make_symbol(arena, "scope-id"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), L0_NIL)))); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "type-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_symbol(arena, "type"), l0_make_pair(arena, l0_make_symbol(arena, "scope-id"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "not-borrowed"), L0_NIL)), L0_NIL)))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "sym"), l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL))), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "inner-frame"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "outer-frames"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "sym"), l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "inner-frame"), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "outer-frames"), L0_NIL))), L0_NIL))), L0_NIL)))), L0_NIL))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "define-type-with-scope"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (64 != 64) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 64, got %d\n", 64); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 65: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 65...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "sym"), l0_make_pair(arena, l0_make_symbol(arena, "new-status"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), L0_NIL))); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "frame"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "outer-frames"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "update-frame"), l0_make_pair(arena, l0_make_symbol(arena, "f"), l0_make_pair(arena, l0_make_symbol(arena, "target-sym"), l0_make_pair(arena, l0_make_symbol(arena, "status"), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "f"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, L0_NIL, L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "binding"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "f"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "rest-frame"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "f"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "binding"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "target-sym"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "target-sym"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-type-from-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "binding"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-scope-id-from-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "binding"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "status"), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "rest-frame"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "binding"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "update-frame"), l0_make_pair(arena, l0_make_symbol(arena, "rest-frame"), l0_make_pair(arena, l0_make_symbol(arena, "target-sym"), l0_make_pair(arena, l0_make_symbol(arena, "status"), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "updated-frame"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "update-frame"), l0_make_pair(arena, l0_make_symbol(arena, "frame"), l0_make_pair(arena, l0_make_symbol(arena, "sym"), l0_make_pair(arena, l0_make_symbol(arena, "new-status"), L0_NIL)))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "length"), l0_make_pair(arena, l0_make_symbol(arena, "updated-frame"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "length"), l0_make_pair(arena, l0_make_symbol(arena, "frame"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "updated-frame"), l0_make_pair(arena, l0_make_symbol(arena, "outer-frames"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "frame"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "update-borrow-status"), l0_make_pair(arena, l0_make_symbol(arena, "sym"), l0_make_pair(arena, l0_make_symbol(arena, "new-status"), l0_make_pair(arena, l0_make_symbol(arena, "outer-frames"), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "update-borrow-status"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (65 != 65) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 65, got %d\n", 65); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 66: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 66...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "type-expr"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "type-expr"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "type-expr"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "->"), L0_NIL)), L0_NIL))), L0_NIL))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "is-function-type?"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (66 != 66) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 66, got %d\n", 66); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 67: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 67...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "func-type-expr"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "is-function-type?"), l0_make_pair(arena, l0_make_symbol(arena, "func-type-expr"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "func-type-expr"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_symbol(arena, "func-type-expr"), L0_NIL)), L0_NIL)), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_symbol(arena, "func-type-expr"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: Invalid function type expression for get-arg-types:"), l0_make_pair(arena, l0_make_symbol(arena, "func-type-expr"), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "get-arg-types"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (67 != 67) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 67, got %d\n", 67); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 68: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 68...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "func-type-expr"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "is-function-type?"), l0_make_pair(arena, l0_make_symbol(arena, "func-type-expr"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "func-type-expr"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cddr"), l0_make_pair(arena, l0_make_symbol(arena, "func-type-expr"), L0_NIL)), L0_NIL)), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "caddr"), l0_make_pair(arena, l0_make_symbol(arena, "func-type-expr"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: Invalid function type expression for get-return-type:"), l0_make_pair(arena, l0_make_symbol(arena, "func-type-expr"), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "get-return-type"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (68 != 68) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 68, got %d\n", 68); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 69: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 69...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "type1"), l0_make_pair(arena, l0_make_symbol(arena, "type2"), L0_NIL)); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "type1"), l0_make_pair(arena, l0_make_symbol(arena, "type2"), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, true), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "type2"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, true), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "type2"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "number"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "type1"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "int"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "type1"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "float"), L0_NIL)), L0_NIL))), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "type1"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "type1"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "ref"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "type2"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "type2"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "ref"), L0_NIL)), L0_NIL))), L0_NIL))))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "inner1"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_symbol(arena, "type1"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "inner2"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_symbol(arena, "type2"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "inner2"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "types-compatible?"), l0_make_pair(arena, l0_make_symbol(arena, "inner1"), l0_make_pair(arena, l0_make_symbol(arena, "inner2"), L0_NIL))), L0_NIL))), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "type2"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "type2"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "or"), L0_NIL)), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "options"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "type2"), L0_NIL)), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "any?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "lambda"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "option-type"), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "types-compatible?"), l0_make_pair(arena, l0_make_symbol(arena, "type1"), l0_make_pair(arena, l0_make_symbol(arena, "option-type"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "options"), L0_NIL))), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "type1"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "type1"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "or"), L0_NIL)), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "type2"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL)), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL)), L0_NIL)))))))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "types-compatible?"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (69 != 69) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 69, got %d\n", 69); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 70: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 70...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL)), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "type"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "type"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "ref"), L0_NIL)), L0_NIL))), L0_NIL))), L0_NIL))), L0_NIL))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "is-ref-type-info?"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (70 != 70) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 70, got %d\n", 70); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 71: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 71...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "is-ref-type-info?"), l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "type-info"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "get-inner-ref-type"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (71 != 71) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 71, got %d\n", 71); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 72: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 72...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "expr"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), l0_make_pair(arena, l0_make_symbol(arena, "current-scope-id"), L0_NIL))); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "integer?"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "int"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "*global-scope-id*"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "not-borrowed"), L0_NIL)), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "boolean?"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "*global-scope-id*"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "not-borrowed"), L0_NIL)), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string?"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "string"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "*global-scope-id*"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "not-borrowed"), L0_NIL)), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "float?"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "float"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "*global-scope-id*"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "not-borrowed"), L0_NIL)), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "nil"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "*global-scope-id*"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "not-borrowed"), L0_NIL)), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol?"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "found-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "lookup-type-info"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), L0_NIL))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_symbol(arena, "found-info"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: Unbound symbol:"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), l0_make_pair(arena, l0_make_string(arena, " in scope:"), l0_make_pair(arena, l0_make_symbol(arena, "current-scope-id"), L0_NIL))))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-borrow-status-from-info"), l0_make_pair(arena, l0_make_symbol(arena, "found-info"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "borrowed-mutably"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Borrow Error: Cannot access symbol '"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), l0_make_pair(arena, l0_make_string(arena, "' because it is mutably borrowed."), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_symbol(arena, "found-info"), L0_NIL)), L0_NIL)))), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "args"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "quote"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "literal-type-of"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "*global-scope-id*"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "not-borrowed"), L0_NIL)), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: quote expects one argument."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "if"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cddr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdddr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL)), L0_NIL))))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: 'if' requires 3 arguments."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "type-of"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), l0_make_pair(arena, l0_make_symbol(arena, "current-scope-id"), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "true-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "type-of"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), l0_make_pair(arena, l0_make_symbol(arena, "current-scope-id"), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "false-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "type-of"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "caddr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), l0_make_pair(arena, l0_make_symbol(arena, "current-scope-id"), L0_NIL)))), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-type-from-info"), l0_make_pair(arena, l0_make_symbol(arena, "cond-info"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "true-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-type-from-info"), l0_make_pair(arena, l0_make_symbol(arena, "true-info"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "false-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-type-from-info"), l0_make_pair(arena, l0_make_symbol(arena, "false-info"), L0_NIL)), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "cond-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "true-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "false-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "cond-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL)), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: 'if' condition must be boolean, got:"), l0_make_pair(arena, l0_make_symbol(arena, "cond-type"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "types-compatible?"), l0_make_pair(arena, l0_make_symbol(arena, "true-type"), l0_make_pair(arena, l0_make_symbol(arena, "false-type"), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "types-compatible?"), l0_make_pair(arena, l0_make_symbol(arena, "false-type"), l0_make_pair(arena, l0_make_symbol(arena, "true-type"), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: 'if' branches have incompatible types:"), l0_make_pair(arena, l0_make_symbol(arena, "true-type"), l0_make_pair(arena, l0_make_string(arena, "and"), l0_make_pair(arena, l0_make_symbol(arena, "false-type"), L0_NIL))))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "true-info"), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_symbol(arena, "true-info"), L0_NIL)), L0_NIL))))))), L0_NIL))), L0_NIL))), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "lambda"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: Invalid lambda form."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "params-with-types"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "body-forms"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "lambda-scope-id"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "generate-scope-id"), L0_NIL), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "extract-params-types"), l0_make_pair(arena, l0_make_symbol(arena, "lst"), l0_make_pair(arena, l0_make_symbol(arena, "names-acc"), l0_make_pair(arena, l0_make_symbol(arena, "types-acc"), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "lst"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "reverse"), l0_make_pair(arena, l0_make_symbol(arena, "names-acc"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "reverse"), l0_make_pair(arena, l0_make_symbol(arena, "types-acc"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "entry"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "lst"), L0_NIL)), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "entry"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "entry"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cddr"), l0_make_pair(arena, l0_make_symbol(arena, "entry"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "entry"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_symbol(arena, "entry"), L0_NIL)), L0_NIL)), L0_NIL)), L0_NIL)))))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: Invalid lambda parameter format:"), l0_make_pair(arena, l0_make_symbol(arena, "entry"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "extract-params-types"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "lst"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "entry"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "names-acc"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_symbol(arena, "entry"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "types-acc"), L0_NIL))), L0_NIL)))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "extracted"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "extract-params-types"), l0_make_pair(arena, l0_make_symbol(arena, "params-with-types"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, L0_NIL, L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, L0_NIL, L0_NIL)), L0_NIL)))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "extracted"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "params"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "extracted"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "param-types"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "extracted"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "lambda-frame"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "map"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "lambda"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "p"), l0_make_pair(arena, l0_make_symbol(arena, "t"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "p"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_symbol(arena, "t"), l0_make_pair(arena, l0_make_symbol(arena, "lambda-scope-id"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "not-borrowed"), L0_NIL)), L0_NIL)))), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "params"), l0_make_pair(arena, l0_make_symbol(arena, "param-types"), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "lambda-tenv"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "extend-type-env"), l0_make_pair(arena, l0_make_symbol(arena, "lambda-frame"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "last-element"), l0_make_pair(arena, l0_make_symbol(arena, "lst"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "lst"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "lst"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "last-element"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "lst"), L0_NIL)), L0_NIL)), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "check-body"), l0_make_pair(arena, l0_make_symbol(arena, "body-list"), l0_make_pair(arena, l0_make_symbol(arena, "env"), l0_make_pair(arena, l0_make_symbol(arena, "scope-id"), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "body-list"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "type-of"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "body-list"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "env"), l0_make_pair(arena, l0_make_symbol(arena, "scope-id"), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "current-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "type-of"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "body-list"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "env"), l0_make_pair(arena, l0_make_symbol(arena, "scope-id"), L0_NIL)))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "current-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "check-body"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "body-list"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "env"), l0_make_pair(arena, l0_make_symbol(arena, "scope-id"), L0_NIL)))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "body-result-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "check-body"), l0_make_pair(arena, l0_make_symbol(arena, "body-forms"), l0_make_pair(arena, l0_make_symbol(arena, "lambda-tenv"), l0_make_pair(arena, l0_make_symbol(arena, "lambda-scope-id"), L0_NIL)))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "body-result-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "is-ref-type-info?"), l0_make_pair(arena, l0_make_symbol(arena, "body-result-info"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "origin-scope"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-scope-id-from-info"), l0_make_pair(arena, l0_make_symbol(arena, "body-result-info"), L0_NIL)), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "origin-scope"), l0_make_pair(arena, l0_make_symbol(arena, "lambda-scope-id"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Lifetime Error: Lambda cannot return reference to internal variable/parameter:"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "body-result-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "->"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "param-types"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-type-from-info"), l0_make_pair(arena, l0_make_symbol(arena, "body-result-info"), L0_NIL)), L0_NIL)))), l0_make_pair(arena, l0_make_symbol(arena, "*global-scope-id*"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "not-borrowed"), L0_NIL)), L0_NIL)))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL))), L0_NIL))))))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "define"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cddr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL))))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "sym"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "val-expr"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "val-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "type-of"), l0_make_pair(arena, l0_make_symbol(arena, "val-expr"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), l0_make_pair(arena, l0_make_symbol(arena, "current-scope-id"), L0_NIL)))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "val-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "val-info"), L0_NIL)))), L0_NIL))), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "func-sig"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "body-forms"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "body-forms"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "func-sig"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "func-sig"), L0_NIL)), L0_NIL)), L0_NIL)), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: Invalid function definition."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "lambda-expr"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "lambda"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "func-sig"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "body-forms"), L0_NIL)))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "type-of"), l0_make_pair(arena, l0_make_symbol(arena, "lambda-expr"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), l0_make_pair(arena, l0_make_symbol(arena, "current-scope-id"), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: Invalid define form:"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), L0_NIL)), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "let"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: Invalid let form."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "bindings"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "body-forms"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let-scope-id"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "generate-scope-id"), L0_NIL), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "build-let-frame"), l0_make_pair(arena, l0_make_symbol(arena, "bindings-list"), l0_make_pair(arena, l0_make_symbol(arena, "outer-tenv"), l0_make_pair(arena, l0_make_symbol(arena, "outer-scope"), l0_make_pair(arena, l0_make_symbol(arena, "frame-acc"), L0_NIL))))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "bindings-list"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "reverse"), l0_make_pair(arena, l0_make_symbol(arena, "frame-acc"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "binding"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "bindings-list"), L0_NIL)), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "binding"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "binding"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cddr"), l0_make_pair(arena, l0_make_symbol(arena, "binding"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "binding"), L0_NIL)), L0_NIL)), L0_NIL)), L0_NIL))))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: Invalid let binding:"), l0_make_pair(arena, l0_make_symbol(arena, "binding"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let*"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "var"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "binding"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "val-expr"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_symbol(arena, "binding"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "val-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "type-of"), l0_make_pair(arena, l0_make_symbol(arena, "val-expr"), l0_make_pair(arena, l0_make_symbol(arena, "outer-tenv"), l0_make_pair(arena, l0_make_symbol(arena, "outer-scope"), L0_NIL)))), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "val-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "error"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "build-let-frame"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "bindings-list"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "outer-tenv"), l0_make_pair(arena, l0_make_symbol(arena, "outer-scope"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "var"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-type-from-info"), l0_make_pair(arena, l0_make_symbol(arena, "val-info"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "let-scope-id"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "not-borrowed"), L0_NIL)), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "frame-acc"), L0_NIL))), L0_NIL))))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let-frame"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "build-let-frame"), l0_make_pair(arena, l0_make_symbol(arena, "bindings"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), l0_make_pair(arena, l0_make_symbol(arena, "current-scope-id"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, L0_NIL, L0_NIL)), L0_NIL))))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "let-frame"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let-tenv"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "extend-type-env"), l0_make_pair(arena, l0_make_symbol(arena, "let-frame"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), L0_NIL))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "last-element"), l0_make_pair(arena, l0_make_symbol(arena, "lst"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "lst"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "lst"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "last-element"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "lst"), L0_NIL)), L0_NIL)), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "check-body"), l0_make_pair(arena, l0_make_symbol(arena, "body-list"), l0_make_pair(arena, l0_make_symbol(arena, "env"), l0_make_pair(arena, l0_make_symbol(arena, "scope-id"), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "body-list"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "type-of"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "body-list"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "env"), l0_make_pair(arena, l0_make_symbol(arena, "scope-id"), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "current-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "type-of"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "body-list"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "env"), l0_make_pair(arena, l0_make_symbol(arena, "scope-id"), L0_NIL)))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "current-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "check-body"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "body-list"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "env"), l0_make_pair(arena, l0_make_symbol(arena, "scope-id"), L0_NIL)))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "body-result-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "check-body"), l0_make_pair(arena, l0_make_symbol(arena, "body-forms"), l0_make_pair(arena, l0_make_symbol(arena, "let-tenv"), l0_make_pair(arena, l0_make_symbol(arena, "let-scope-id"), L0_NIL)))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "body-result-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "is-ref-type-info?"), l0_make_pair(arena, l0_make_symbol(arena, "body-result-info"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "origin-scope"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-scope-id-from-info"), l0_make_pair(arena, l0_make_symbol(arena, "body-result-info"), L0_NIL)), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "origin-scope"), l0_make_pair(arena, l0_make_symbol(arena, "let-scope-id"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Lifetime Error: Let cannot return reference to internal binding:"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "body-result-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "body-result-info"), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL))), L0_NIL))))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "ref"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: 'ref' requires exactly one argument."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "operand-expr"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol?"), l0_make_pair(arena, l0_make_symbol(arena, "operand-expr"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Borrow Error: Can only take reference of a symbol, not expression:"), l0_make_pair(arena, l0_make_symbol(arena, "operand-expr"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "operand-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "type-of"), l0_make_pair(arena, l0_make_symbol(arena, "operand-expr"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), l0_make_pair(arena, l0_make_symbol(arena, "current-scope-id"), L0_NIL)))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "operand-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-borrow-status-from-info"), l0_make_pair(arena, l0_make_symbol(arena, "operand-info"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "borrowed-mutably"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Borrow Error: Cannot take reference of '"), l0_make_pair(arena, l0_make_symbol(arena, "operand-expr"), l0_make_pair(arena, l0_make_string(arena, "' because it is already mutably borrowed."), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "ref"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-type-from-info"), l0_make_pair(arena, l0_make_symbol(arena, "operand-info"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-scope-id-from-info"), l0_make_pair(arena, l0_make_symbol(arena, "operand-info"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "not-borrowed"), L0_NIL)), L0_NIL)))), L0_NIL)), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "deref"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: 'deref' requires exactly one argument."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "ref-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "type-of"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), l0_make_pair(arena, l0_make_symbol(arena, "current-scope-id"), L0_NIL)))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "ref-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "is-ref-type-info?"), l0_make_pair(arena, l0_make_symbol(arena, "ref-info"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: 'deref' requires a reference type, got:"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-type-from-info"), l0_make_pair(arena, l0_make_symbol(arena, "ref-info"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-inner-ref-type"), l0_make_pair(arena, l0_make_symbol(arena, "ref-info"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-scope-id-from-info"), l0_make_pair(arena, l0_make_symbol(arena, "ref-info"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-borrow-status-from-info"), l0_make_pair(arena, l0_make_symbol(arena, "ref-info"), L0_NIL)), L0_NIL)))), L0_NIL)), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "op-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "type-of"), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), l0_make_pair(arena, l0_make_symbol(arena, "current-scope-id"), L0_NIL)))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "op-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "op-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-type-from-info"), l0_make_pair(arena, l0_make_symbol(arena, "op-info"), L0_NIL)), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "is-function-type?"), l0_make_pair(arena, l0_make_symbol(arena, "op-type"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: Attempting to call non-function:"), l0_make_pair(arena, l0_make_symbol(arena, "op"), l0_make_pair(arena, l0_make_string(arena, " which has type:"), l0_make_pair(arena, l0_make_symbol(arena, "op-type"), L0_NIL))))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "expected-arg-types"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-arg-types"), l0_make_pair(arena, l0_make_symbol(arena, "op-type"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "return-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-return-type"), l0_make_pair(arena, l0_make_symbol(arena, "op-type"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "actual-arg-exprs"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "expected-arg-types"), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "return-type"), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "actual-arg-infos"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "map"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "lambda"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "arg-expr"), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "type-of"), l0_make_pair(arena, l0_make_symbol(arena, "arg-expr"), l0_make_pair(arena, l0_make_symbol(arena, "tenv"), l0_make_pair(arena, l0_make_symbol(arena, "current-scope-id"), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "actual-arg-exprs"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "arg-info-error?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "lambda"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "info"), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "any?"), l0_make_pair(arena, l0_make_symbol(arena, "arg-info-error?"), l0_make_pair(arena, l0_make_symbol(arena, "actual-arg-infos"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "actual-arg-types"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "map"), l0_make_pair(arena, l0_make_symbol(arena, "get-type-from-info"), l0_make_pair(arena, l0_make_symbol(arena, "actual-arg-infos"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "check-args"), l0_make_pair(arena, l0_make_symbol(arena, "expected-arg-types"), l0_make_pair(arena, l0_make_symbol(arena, "actual-arg-types"), l0_make_pair(arena, l0_make_symbol(arena, "op"), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_symbol(arena, "return-type"), l0_make_pair(arena, l0_make_symbol(arena, "*global-scope-id*"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "not-borrowed"), L0_NIL)), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL)))), L0_NIL)))), L0_NIL))), L0_NIL)), L0_NIL))), L0_NIL))), L0_NIL)), L0_NIL))), L0_NIL))), L0_NIL)), L0_NIL))))))))), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: Unknown expression form:"), l0_make_pair(arena, l0_make_symbol(arena, "expr"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), L0_NIL))))))))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "type-of"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (72 != 72) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 72, got %d\n", 72); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 73: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 73...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "literal"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "integer?"), l0_make_pair(arena, l0_make_symbol(arena, "literal"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "int"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "boolean?"), l0_make_pair(arena, l0_make_symbol(arena, "literal"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string?"), l0_make_pair(arena, l0_make_symbol(arena, "literal"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "string"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "float?"), l0_make_pair(arena, l0_make_symbol(arena, "literal"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "float"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "literal"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "nil"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol?"), l0_make_pair(arena, l0_make_symbol(arena, "literal"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "symbol"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "literal"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "pair"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "unknown-literal-type"), L0_NIL)), L0_NIL)), L0_NIL))))))))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "literal-type-of"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (73 != 73) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 73, got %d\n", 73); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 74: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 74...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "forms"), l0_make_pair(arena, l0_make_symbol(arena, "initial-tenv"), L0_NIL)); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "--- Starting Type Checking Pass (with scope and borrow checks) ---"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "check-forms-iter"), l0_make_pair(arena, l0_make_symbol(arena, "forms"), l0_make_pair(arena, l0_make_symbol(arena, "current-tenv"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "forms"), L0_NIL)), l0_make_pair(arena, l0_make_boolean(arena, true), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "form"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "forms"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "remaining-forms"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "forms"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "form-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "type-of"), l0_make_pair(arena, l0_make_symbol(arena, "form"), l0_make_pair(arena, l0_make_symbol(arena, "current-tenv"), l0_make_pair(arena, l0_make_symbol(arena, "*global-scope-id*"), L0_NIL)))), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "form-info"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "[Type Check Program] Error detected in form, stopping."), L0_NIL)), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "define"), L0_NIL)), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "updated-tenv"), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cddr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdddr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), L0_NIL))))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "sym"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "defined-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-type-from-info"), l0_make_pair(arena, l0_make_symbol(arena, "form-info"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "[Type Check Program] Defining"), l0_make_pair(arena, l0_make_symbol(arena, "sym"), l0_make_pair(arena, l0_make_string(arena, "with type"), l0_make_pair(arena, l0_make_symbol(arena, "defined-type"), L0_NIL))))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "set!"), l0_make_pair(arena, l0_make_symbol(arena, "updated-tenv"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define-type-with-scope"), l0_make_pair(arena, l0_make_symbol(arena, "sym"), l0_make_pair(arena, l0_make_symbol(arena, "defined-type"), l0_make_pair(arena, l0_make_symbol(arena, "*global-scope-id*"), l0_make_pair(arena, l0_make_symbol(arena, "current-tenv"), L0_NIL))))), L0_NIL))), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "func-sig"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "func-sig"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type Error: Invalid function definition signature:"), l0_make_pair(arena, l0_make_symbol(arena, "func-sig"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "set!"), l0_make_pair(arena, l0_make_symbol(arena, "updated-tenv"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "func-name"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "func-sig"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "func-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-type-from-info"), l0_make_pair(arena, l0_make_symbol(arena, "form-info"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "[Type Check Program] Defining function"), l0_make_pair(arena, l0_make_symbol(arena, "func-name"), l0_make_pair(arena, l0_make_string(arena, "with inferred type"), l0_make_pair(arena, l0_make_symbol(arena, "func-type"), L0_NIL))))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "set!"), l0_make_pair(arena, l0_make_symbol(arena, "updated-tenv"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define-type-with-scope"), l0_make_pair(arena, l0_make_symbol(arena, "func-name"), l0_make_pair(arena, l0_make_symbol(arena, "func-type"), l0_make_pair(arena, l0_make_symbol(arena, "*global-scope-id*"), l0_make_pair(arena, l0_make_symbol(arena, "current-tenv"), L0_NIL))))), L0_NIL))), L0_NIL)))), L0_NIL)))), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "[Type Check Program] Unexpected invalid define form."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "set!"), l0_make_pair(arena, l0_make_symbol(arena, "updated-tenv"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), L0_NIL))), L0_NIL)), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "updated-tenv"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "check-forms-iter"), l0_make_pair(arena, l0_make_symbol(arena, "remaining-forms"), l0_make_pair(arena, l0_make_symbol(arena, "updated-tenv"), L0_NIL))), L0_NIL)))), L0_NIL)))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "check-forms-iter"), l0_make_pair(arena, l0_make_symbol(arena, "remaining-forms"), l0_make_pair(arena, l0_make_symbol(arena, "current-tenv"), L0_NIL))), L0_NIL)), L0_NIL)))), L0_NIL))), L0_NIL))), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "create-initial-tenv"), l0_make_pair(arena, l0_make_symbol(arena, "primitive-types"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "map"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "lambda"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "entry"), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "entry"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "entry"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "*global-scope-id*"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "not-borrowed"), L0_NIL)), L0_NIL)))), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "primitive-types"), L0_NIL))), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "tenv-with-prims"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "create-initial-tenv"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "any"), l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "pair"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair"), L0_NIL), l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair"), L0_NIL), l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "+"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "number"), l0_make_pair(arena, l0_make_symbol(arena, "..."), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "number"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "-"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "number"), l0_make_pair(arena, l0_make_symbol(arena, "..."), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "number"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "*"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "number"), l0_make_pair(arena, l0_make_symbol(arena, "..."), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "number"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "/"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "number"), l0_make_pair(arena, l0_make_symbol(arena, "..."), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "float"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "number"), l0_make_pair(arena, l0_make_symbol(arena, "number"), l0_make_pair(arena, l0_make_symbol(arena, "..."), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "<"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "number"), l0_make_pair(arena, l0_make_symbol(arena, "number"), l0_make_pair(arena, l0_make_symbol(arena, "..."), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, ">"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "number"), l0_make_pair(arena, l0_make_symbol(arena, "number"), l0_make_pair(arena, l0_make_symbol(arena, "..."), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "integer?"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "boolean?"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol?"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string?"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "float?"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "closure?"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string-append"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string"), l0_make_pair(arena, l0_make_symbol(arena, "..."), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "string"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string->symbol"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string"), L0_NIL), l0_make_pair(arena, l0_make_symbol(arena, "symbol"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol->string"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol"), L0_NIL), l0_make_pair(arena, l0_make_symbol(arena, "string"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "any"), l0_make_pair(arena, l0_make_symbol(arena, "..."), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "read-file"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string"), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_symbol(arena, "string"), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL))), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "write-file"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string"), l0_make_pair(arena, l0_make_symbol(arena, "string"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "command-line-args"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, L0_NIL, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_symbol(arena, "string"), L0_NIL)), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "parse-string"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string"), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL))), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "codegen-program"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_symbol(arena, "string"), l0_make_pair(arena, l0_make_symbol(arena, "bool"), L0_NIL))), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "append"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_symbol(arena, "..."), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "list"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "eval"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL), l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "apply"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "any"), l0_make_pair(arena, l0_make_symbol(arena, "list"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "eval-in-compiler-env"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL), l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "deref"), l0_make_pair(arena, l0_make_symbol(arena, "."), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "->"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "ref"), l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_symbol(arena, "any"), L0_NIL))), L0_NIL))), L0_NIL)))))))))))))))))))))))))))))))), L0_NIL)), L0_NIL)), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "check-forms-iter"), l0_make_pair(arena, l0_make_symbol(arena, "forms"), l0_make_pair(arena, l0_make_symbol(arena, "tenv-with-prims"), L0_NIL))), L0_NIL))), L0_NIL)))); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "type-check-program"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (74 != 74) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 74, got %d\n", 74); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 75: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 75...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "strings"), l0_make_pair(arena, l0_make_symbol(arena, "sep"), L0_NIL)); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "strings"), L0_NIL)), l0_make_pair(arena, l0_make_string(arena, ""), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "strings"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "strings"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string-append"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "strings"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "sep"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string-join"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "strings"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "sep"), L0_NIL))), L0_NIL)))), L0_NIL)))), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "string-join"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (75 != 75) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 75, got %d\n", 75); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 76: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 76...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "type-sym"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "type-sym"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "c-void"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_string(arena, "void"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "type-sym"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "c-int"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_string(arena, "int"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "type-sym"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "c-long"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_string(arena, "long"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "type-sym"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "c-float"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_string(arena, "float"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "type-sym"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "c-double"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_string(arena, "double"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "type-sym"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "c-char"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_string(arena, "char"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "type-sym"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "c-string"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_string(arena, "const char*"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "type-sym"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "c-ptr"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_string(arena, "void*"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "type-sym"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "l0-value"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_string(arena, "L0_Value*"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: Unknown C FFI type symbol:"), l0_make_pair(arena, l0_make_symbol(arena, "type-sym"), L0_NIL))), l0_make_pair(arena, l0_make_string(arena, "/* unknown_type */"), L0_NIL))), L0_NIL)), L0_NIL))))))))))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "cheng-type-symbol->c-type-string"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (76 != 76) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 76, got %d\n", 76); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 77: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 77...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "<"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "length"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), l0_make_pair(arena, l0_make_integer(arena, 5L), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: Invalid c-declare form:"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cheng-name"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "c-name-str"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "caddr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "ret-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadddr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "arg-types"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cddddr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), L0_NIL)), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol?"), l0_make_pair(arena, l0_make_symbol(arena, "cheng-name"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: c-declare Cheng name must be a symbol:"), l0_make_pair(arena, l0_make_symbol(arena, "cheng-name"), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string?"), l0_make_pair(arena, l0_make_symbol(arena, "c-name-str"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: c-declare C name must be a string:"), l0_make_pair(arena, l0_make_symbol(arena, "c-name-str"), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol?"), l0_make_pair(arena, l0_make_symbol(arena, "ret-type"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: c-declare return type must be a symbol:"), l0_make_pair(arena, l0_make_symbol(arena, "ret-type"), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list?"), l0_make_pair(arena, l0_make_symbol(arena, "arg-types"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: c-declare argument types must be a list:"), l0_make_pair(arena, l0_make_symbol(arena, "arg-types"), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_symbol(arena, "cheng-name"), l0_make_pair(arena, l0_make_symbol(arena, "c-name-str"), l0_make_pair(arena, l0_make_symbol(arena, "ret-type"), l0_make_pair(arena, l0_make_symbol(arena, "arg-types"), L0_NIL))))), L0_NIL)))), L0_NIL)))), L0_NIL)))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "process-c-declare"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (77 != 77) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 77, got %d\n", 77); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 78: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 78...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "<"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "length"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), l0_make_pair(arena, l0_make_integer(arena, 5L), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: Invalid c-export form:"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "c-name-str"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cheng-fn-name"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "caddr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "ret-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadddr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "arg-types"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cddddr"), l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL)), L0_NIL)), L0_NIL)), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string?"), l0_make_pair(arena, l0_make_symbol(arena, "c-name-str"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: c-export C name must be a string:"), l0_make_pair(arena, l0_make_symbol(arena, "c-name-str"), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol?"), l0_make_pair(arena, l0_make_symbol(arena, "cheng-fn-name"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: c-export Cheng function name must be a symbol:"), l0_make_pair(arena, l0_make_symbol(arena, "cheng-fn-name"), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol?"), l0_make_pair(arena, l0_make_symbol(arena, "ret-type"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: c-export return type must be a symbol:"), l0_make_pair(arena, l0_make_symbol(arena, "ret-type"), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list?"), l0_make_pair(arena, l0_make_symbol(arena, "arg-types"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Error: c-export argument types must be a list:"), l0_make_pair(arena, l0_make_symbol(arena, "arg-types"), L0_NIL))), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string-append"), l0_make_pair(arena, l0_make_string(arena, "// --- Placeholder C Export Wrapper for "), l0_make_pair(arena, l0_make_symbol(arena, "c-name-str"), l0_make_pair(arena, l0_make_string(arena, " ---\n"), l0_make_pair(arena, l0_make_string(arena, "// TODO: Implement actual type conversion and function call\n"), l0_make_pair(arena, l0_make_string(arena, "// Signature: "), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol->string"), l0_make_pair(arena, l0_make_symbol(arena, "ret-type"), L0_NIL)), l0_make_pair(arena, l0_make_string(arena, " "), l0_make_pair(arena, l0_make_symbol(arena, "c-name-str"), l0_make_pair(arena, l0_make_string(arena, "("), l0_make_pair(arena, l0_make_string(arena, ") {\n"), l0_make_pair(arena, l0_make_string(arena, "    // 1. Convert C args to L0_Value*\n"), l0_make_pair(arena, l0_make_string(arena, "    // 2. Find Cheng function '"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol->string"), l0_make_pair(arena, l0_make_symbol(arena, "cheng-fn-name"), L0_NIL)), l0_make_pair(arena, l0_make_string(arena, "'\n"), l0_make_pair(arena, l0_make_string(arena, "    // 3. Call Cheng function using l0_apply or similar\n"), l0_make_pair(arena, l0_make_string(arena, "    // 4. Convert L0_Value* result back to C "), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol->string"), l0_make_pair(arena, l0_make_symbol(arena, "ret-type"), L0_NIL)), l0_make_pair(arena, l0_make_string(arena, "\n"), l0_make_pair(arena, l0_make_string(arena, "    // 5. Return C result\n"), l0_make_pair(arena, l0_make_string(arena, "    printf(\"Warning: C export wrapper for "), l0_make_pair(arena, l0_make_symbol(arena, "c-name-str"), l0_make_pair(arena, l0_make_string(arena, " is not implemented!\\n\");\n"), l0_make_pair(arena, l0_make_string(arena, "    return ("), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol->string"), l0_make_pair(arena, l0_make_symbol(arena, "ret-type"), L0_NIL)), l0_make_pair(arena, l0_make_string(arena, ")0; // Placeholder return\n"), l0_make_pair(arena, l0_make_string(arena, "}\n\n"), L0_NIL))))))))))))))))))))))))))), L0_NIL)))), L0_NIL)))), L0_NIL)))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "process-c-export"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (78 != 78) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 78, got %d\n", 78); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 79: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 79...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "forms"), l0_make_pair(arena, l0_make_symbol(arena, "table"), L0_NIL)); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Expanding top-level forms (including FFI)..."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "defmacros"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "filter"), l0_make_pair(arena, l0_make_symbol(arena, "is-defmacro?"), l0_make_pair(arena, l0_make_symbol(arena, "forms"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "c_declarations"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "filter"), l0_make_pair(arena, l0_make_symbol(arena, "is-c-declare?"), l0_make_pair(arena, l0_make_symbol(arena, "forms"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "c_exports"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "filter"), l0_make_pair(arena, l0_make_symbol(arena, "is-c-export?"), l0_make_pair(arena, l0_make_symbol(arena, "forms"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "base_forms"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "filter"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "lambda"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "f"), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "is-defmacro?"), l0_make_pair(arena, l0_make_symbol(arena, "f"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "is-c-declare?"), l0_make_pair(arena, l0_make_symbol(arena, "f"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "is-c-export?"), l0_make_pair(arena, l0_make_symbol(arena, "f"), L0_NIL)), L0_NIL)), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "forms"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Found defmacros:"), l0_make_pair(arena, l0_make_symbol(arena, "defmacros"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Found c-declarations:"), l0_make_pair(arena, l0_make_symbol(arena, "c_declarations"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Found c-exports:"), l0_make_pair(arena, l0_make_symbol(arena, "c_exports"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Base forms:"), l0_make_pair(arena, l0_make_symbol(arena, "base_forms"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "register-macros"), l0_make_pair(arena, l0_make_symbol(arena, "macro-defs"), l0_make_pair(arena, l0_make_symbol(arena, "current-table"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "macro-defs"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "current-table"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "macro-pair"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "process-defmacro"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "macro-defs"), L0_NIL)), L0_NIL)), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_symbol(arena, "macro-pair"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "register-macros"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "macro-defs"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "macro-pair"), l0_make_pair(arena, l0_make_symbol(arena, "current-table"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "register-macros"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "macro-defs"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "current-table"), L0_NIL))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "set!"), l0_make_pair(arena, l0_make_symbol(arena, "*macro-table*"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "register-macros"), l0_make_pair(arena, l0_make_symbol(arena, "defmacros"), l0_make_pair(arena, l0_make_symbol(arena, "*macro-table*"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Updated macro table:"), l0_make_pair(arena, l0_make_symbol(arena, "*macro-table*"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "register-c-declarations"), l0_make_pair(arena, l0_make_symbol(arena, "decls"), l0_make_pair(arena, l0_make_symbol(arena, "current-decls"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "decls"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "current-decls"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "processed"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "process-c-declare"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "decls"), L0_NIL)), L0_NIL)), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_symbol(arena, "processed"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "register-c-declarations"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "decls"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "processed"), l0_make_pair(arena, l0_make_symbol(arena, "current-decls"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "register-c-declarations"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "decls"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "current-decls"), L0_NIL))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "set!"), l0_make_pair(arena, l0_make_symbol(arena, "*c-declarations*"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "register-c-declarations"), l0_make_pair(arena, l0_make_symbol(arena, "c_declarations"), l0_make_pair(arena, l0_make_symbol(arena, "*c-declarations*"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Updated c-declarations list:"), l0_make_pair(arena, l0_make_symbol(arena, "*c-declarations*"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "register-c-exports"), l0_make_pair(arena, l0_make_symbol(arena, "exports"), l0_make_pair(arena, l0_make_symbol(arena, "current-exports-code"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_symbol(arena, "exports"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "current-exports-code"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "wrapper-code"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "process-c-export"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "exports"), L0_NIL)), L0_NIL)), L0_NIL)), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_symbol(arena, "wrapper-code"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "register-c-exports"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "exports"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_symbol(arena, "wrapper-code"), l0_make_pair(arena, l0_make_symbol(arena, "current-exports-code"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "register-c-exports"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "exports"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "current-exports-code"), L0_NIL))), L0_NIL)))), L0_NIL))), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "set!"), l0_make_pair(arena, l0_make_symbol(arena, "*c-exports-code*"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "register-c-exports"), l0_make_pair(arena, l0_make_symbol(arena, "c_exports"), l0_make_pair(arena, l0_make_symbol(arena, "*c-exports-code*"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Updated c-exports code list (placeholders):"), l0_make_pair(arena, l0_make_symbol(arena, "*c-exports-code*"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "expanded-base"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "map"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "lambda"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "form"), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "macro-expand"), l0_make_pair(arena, l0_make_symbol(arena, "form"), l0_make_pair(arena, l0_make_symbol(arena, "*macro-table*"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "base_forms"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Expansion complete. Returning expanded base forms."), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "expanded-base"), L0_NIL))))))))))))))))))))); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "expand-macros-top-level"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (79 != 79) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 79, got %d\n", 79); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 80: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 80...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "error-type"), l0_make_pair(arena, l0_make_symbol(arena, "filename"), L0_NIL)); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "base-message"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cond"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "error-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "read-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string-append"), l0_make_pair(arena, l0_make_string(arena, "Error reading file: "), l0_make_pair(arena, l0_make_symbol(arena, "filename"), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "error-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "parse-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string-append"), l0_make_pair(arena, l0_make_string(arena, "Error parsing file: "), l0_make_pair(arena, l0_make_symbol(arena, "filename"), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "error-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "codegen-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string-append"), l0_make_pair(arena, l0_make_string(arena, "Error generating code for: "), l0_make_pair(arena, l0_make_symbol(arena, "filename"), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "error-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "write-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string-append"), l0_make_pair(arena, l0_make_string(arena, "Error writing output file: "), l0_make_pair(arena, l0_make_symbol(arena, "filename"), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "error-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "arg-type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_string(arena, "Error: Command line arguments must be strings."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "error-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "arg-count-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_string(arena, "Error: Expected exactly two command line arguments."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "else"), l0_make_pair(arena, l0_make_string(arena, "Unknown error."), L0_NIL)), L0_NIL)))))))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "reason"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-last-error-message"), L0_NIL), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "reason-str"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string?"), l0_make_pair(arena, l0_make_symbol(arena, "reason"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string-append"), l0_make_pair(arena, l0_make_string(arena, " Reason: "), l0_make_pair(arena, l0_make_symbol(arena, "reason"), L0_NIL))), l0_make_pair(arena, l0_make_string(arena, " Reason: (unknown - no message from primitive)"), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "location-str"), l0_make_pair(arena, l0_make_string(arena, ""), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "or"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "error-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "parse-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "="), l0_make_pair(arena, l0_make_symbol(arena, "error-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "codegen-error"), L0_NIL)), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "err-line"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-last-error-line"), L0_NIL), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "err-col"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "get-last-error-col"), L0_NIL), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "set!"), l0_make_pair(arena, l0_make_symbol(arena, "location-str"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string-append"), l0_make_pair(arena, l0_make_string(arena, " At Line: "), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "number->string"), l0_make_pair(arena, l0_make_symbol(arena, "err-line"), L0_NIL)), l0_make_pair(arena, l0_make_string(arena, " Col: "), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "number->string"), l0_make_pair(arena, l0_make_symbol(arena, "err-col"), L0_NIL)), L0_NIL))))), L0_NIL))), L0_NIL)))), l0_make_pair(arena, L0_NIL, L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string-append"), l0_make_pair(arena, l0_make_symbol(arena, "base-message"), l0_make_pair(arena, l0_make_symbol(arena, "location-str"), l0_make_pair(arena, l0_make_symbol(arena, "reason-str"), L0_NIL)))), L0_NIL)))))); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "format-error"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (80 != 80) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 80, got %d\n", 80); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 81: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 81...\n"); fflush(stdout); // DEBUG
    { L0_Value* lambda_val = ({ L0_Value* lambda_params = l0_make_pair(arena, l0_make_symbol(arena, "input-filename"), l0_make_pair(arena, l0_make_symbol(arena, "output-filename"), L0_NIL)); L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Reading input file: "), l0_make_pair(arena, l0_make_symbol(arena, "input-filename"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "source-content"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "read-file"), l0_make_pair(arena, l0_make_symbol(arena, "input-filename"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "boolean?"), l0_make_pair(arena, l0_make_symbol(arena, "source-content"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "format-error"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "read-error"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "input-filename"), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "read-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Parsing L0 code..."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "ast"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "parse-string"), l0_make_pair(arena, l0_make_symbol(arena, "source-content"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "boolean?"), l0_make_pair(arena, l0_make_symbol(arena, "ast"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "format-error"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "parse-error"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "input-filename"), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "parse-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Parsing successful. AST:"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Processing top-level forms (Macros, FFI)..."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "set!"), l0_make_pair(arena, l0_make_symbol(arena, "*c-declarations*"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, L0_NIL, L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "set!"), l0_make_pair(arena, l0_make_symbol(arena, "*c-exports-code*"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, L0_NIL, L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "expanded-base-ast"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "expand-macros-top-level"), l0_make_pair(arena, l0_make_symbol(arena, "ast"), l0_make_pair(arena, l0_make_symbol(arena, "*macro-table*"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Top-level processing complete. Final base AST for codegen:"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Running type checking pass..."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "create-initial-tenv"), l0_make_pair(arena, l0_make_symbol(arena, "primitive-types"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "list"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "map"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "lambda"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "entry"), L0_NIL), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cons"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "entry"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "entry"), L0_NIL)), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "primitive-types"), L0_NIL))), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Running type checking pass (with scope checks)..."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "type-check-ok"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "type-check-program"), l0_make_pair(arena, l0_make_symbol(arena, "expanded-base-ast"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, L0_NIL, L0_NIL)), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "not"), l0_make_pair(arena, l0_make_symbol(arena, "type-check-ok"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type checking failed."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "type-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Type checking successful."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Generating C code from expanded base AST..."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "base-c-code"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "codegen-program"), l0_make_pair(arena, l0_make_symbol(arena, "expanded-base-ast"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "boolean?"), l0_make_pair(arena, l0_make_symbol(arena, "base-c-code"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "format-error"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "codegen-error"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "input-filename"), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "codegen-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Base code generation successful."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Assembling final C code (Prototypes + Exports + Base Code)..."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "generate-c-prototype"), l0_make_pair(arena, l0_make_symbol(arena, "decl"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "let"), l0_make_pair(arena, l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "c-ret-type"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cheng-type-symbol->c-type-string"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "caddr"), l0_make_pair(arena, l0_make_symbol(arena, "decl"), L0_NIL)), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "c-name"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadr"), l0_make_pair(arena, l0_make_symbol(arena, "decl"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "c-arg-types"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "map"), l0_make_pair(arena, l0_make_symbol(arena, "cheng-type-symbol->c-type-string"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cadddr"), l0_make_pair(arena, l0_make_symbol(arena, "decl"), L0_NIL)), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cheng-name"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "decl"), L0_NIL)), L0_NIL)), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "c-arg-str"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string-join"), l0_make_pair(arena, l0_make_symbol(arena, "c-arg-types"), l0_make_pair(arena, l0_make_string(arena, ", "), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string-append"), l0_make_pair(arena, l0_make_string(arena, "extern "), l0_make_pair(arena, l0_make_symbol(arena, "c-ret-type"), l0_make_pair(arena, l0_make_string(arena, " "), l0_make_pair(arena, l0_make_symbol(arena, "c-name"), l0_make_pair(arena, l0_make_string(arena, "("), l0_make_pair(arena, l0_make_symbol(arena, "c-arg-str"), l0_make_pair(arena, l0_make_string(arena, "); // From: "), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "symbol->string"), l0_make_pair(arena, l0_make_symbol(arena, "cheng-name"), L0_NIL)), l0_make_pair(arena, l0_make_string(arena, "\n"), L0_NIL)))))))))), L0_NIL)))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "prototypes-code"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string-join"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "map"), l0_make_pair(arena, l0_make_symbol(arena, "generate-c-prototype"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "reverse"), l0_make_pair(arena, l0_make_symbol(arena, "*c-declarations*"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_string(arena, ""), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "exports-code-str"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string-join"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "reverse"), l0_make_pair(arena, l0_make_symbol(arena, "*c-exports-code*"), L0_NIL)), l0_make_pair(arena, l0_make_string(arena, ""), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "final-c-code"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string-append"), l0_make_pair(arena, l0_make_string(arena, "// --- C Declarations ---\n"), l0_make_pair(arena, l0_make_symbol(arena, "prototypes-code"), l0_make_pair(arena, l0_make_string(arena, "\n// --- C Exports ---\n"), l0_make_pair(arena, l0_make_symbol(arena, "exports-code-str"), l0_make_pair(arena, l0_make_string(arena, "\n// --- Generated Base Code ---\n"), l0_make_pair(arena, l0_make_symbol(arena, "base-c-code"), L0_NIL))))))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Final C code assembled."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Writing output file: "), l0_make_pair(arena, l0_make_symbol(arena, "output-filename"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "write-ok"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "write-file"), l0_make_pair(arena, l0_make_symbol(arena, "output-filename"), l0_make_pair(arena, l0_make_symbol(arena, "final-c-code"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_symbol(arena, "write-ok"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Output written successfully."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "success"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "format-error"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "write-error"), L0_NIL)), l0_make_pair(arena, l0_make_symbol(arena, "output-filename"), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "write-error"), L0_NIL)), L0_NIL))), L0_NIL)))), L0_NIL))))))))))), L0_NIL)))), L0_NIL))))), L0_NIL)))), L0_NIL)))))))))))), L0_NIL)))), L0_NIL)))), L0_NIL)))), L0_NIL))); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (lambda_val != NULL) { (void)l0_env_define(env, l0_make_symbol(arena, "compile-l0"), lambda_val); } else { /* Lambda creation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (81 != 81) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 81, got %d\n", 81); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 82: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 82...\n"); fflush(stdout); // DEBUG
    { L0_Value* define_val = ({ L0_Value* lambda_params = L0_NIL; L0_Value* lambda_body = l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "L0 Compiler (Stage 1) starting..."), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "--- Stage 1 Compiler: String Test ---"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "args"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "command-line-args"), L0_NIL), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "Command line args received:"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "result"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "init-error"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "pair?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "null?"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL)), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "input-filename"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "define"), l0_make_pair(arena, l0_make_symbol(arena, "output-filename"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "car"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "cdr"), l0_make_pair(arena, l0_make_symbol(arena, "args"), L0_NIL)), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "if"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "and"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string?"), l0_make_pair(arena, l0_make_symbol(arena, "input-filename"), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "string?"), l0_make_pair(arena, l0_make_symbol(arena, "output-filename"), L0_NIL)), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "set!"), l0_make_pair(arena, l0_make_symbol(arena, "result"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "compile-l0"), l0_make_pair(arena, l0_make_symbol(arena, "input-filename"), l0_make_pair(arena, l0_make_symbol(arena, "output-filename"), L0_NIL))), L0_NIL))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "format-error"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "arg-type-error"), L0_NIL)), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "set!"), l0_make_pair(arena, l0_make_symbol(arena, "result"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "arg-type-error"), L0_NIL)), L0_NIL))), L0_NIL))), L0_NIL)))), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "begin"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "format-error"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "arg-count-error"), L0_NIL)), l0_make_pair(arena, l0_make_boolean(arena, false), L0_NIL))), L0_NIL)), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "set!"), l0_make_pair(arena, l0_make_symbol(arena, "result"), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "quasiquote"), l0_make_pair(arena, l0_make_symbol(arena, "arg-count-error"), L0_NIL)), L0_NIL))), L0_NIL))), L0_NIL)))), l0_make_pair(arena, l0_make_pair(arena, l0_make_symbol(arena, "print"), l0_make_pair(arena, l0_make_string(arena, "L0 Compiler finished with result: "), l0_make_pair(arena, l0_make_symbol(arena, "result"), L0_NIL))), l0_make_pair(arena, l0_make_symbol(arena, "result"), L0_NIL)))))))); l0_make_closure(arena, lambda_params, lambda_body, env); }); if (define_val != NULL && l0_parser_error_status == L0_PARSE_OK) { (void)l0_env_define(env, l0_make_symbol(arena, "main"), define_val); } else { /* Value evaluation failed */ } }
    temp_result = L0_NIL; // Define returns NIL
    if (82 != 82) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 82, got %d\n", 82); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG
    // --- Block 83: Processing top-level expression ---
    fprintf(stdout, "[DEBUG C main] Executing Block 83...\n"); fflush(stdout); // DEBUG
    temp_result = l0_apply(l0_env_lookup(env, l0_make_symbol(arena, "main")), L0_NIL, env, arena);
    if (83 != 83) { fprintf(stdout, "[FATAL CODEGEN CORRUPTION] block_num mismatch after codegen_expr_c! Expected 83, got %d\n", 83); fflush(stdout); exit(99); } // Check block_num integrity
    if (temp_result == NULL || l0_parser_error_status != L0_PARSE_OK) {
        fprintf(stdout, "[DEBUG C main] Error encountered after processing a block.\n"); fflush(stdout); // DEBUG
        fprintf(stdout, "Runtime Error: %s\n", l0_parser_error_message ? l0_parser_error_message : "(unknown)"); fflush(stdout);
        last_result = NULL; // Mark overall result as error
        exit_code = 1;
        goto cleanup; // Skip remaining expressions
    }
    last_result = temp_result; // Store successful result
    fprintf(stdout, "[DEBUG C main] Block finished successfully.\n"); fflush(stdout); // DEBUG

cleanup: // Label for jumping on error
    // --- MODIFIED: Don't print L0 result, just use exit_code --- 
    // if (last_result == NULL) {
    //     printf("Result: <RUNTIME_ERROR>\n");
    // } else {
    //     char print_buffer[1024];
    //     l0_value_to_string_recursive(last_result, print_buffer, sizeof(print_buffer), arena, 0);
    //     printf("Result: %s\n", print_buffer);
    // }
    // --- END MODIFICATION --- 

    fprintf(stdout, "[DEBUG C main] Reached cleanup. exit_code = %d\n", exit_code); fflush(stdout);
    l0_arena_destroy(arena); 
    fprintf(stdout, "[DEBUG C main] Arena destroyed. Returning %d\n", exit_code); fflush(stdout);
    return exit_code;
}

// Note: l0_value_to_string_recursive is defined in l0_primitives.c and should be linked.
